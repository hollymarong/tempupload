webpackJsonp([1],{104:function(e,t,n){n(88);var s=n(33)(n(41),n(105),"data-v-61de597d",null);e.exports=s.exports},105:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"chat"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isConnect,expression:"!isConnect"}],staticClass:"login"},[n("span",{staticClass:"joinbtn",on:{click:e.handleJoinBtnClick}},[e._v("点击进入聊天室")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isConnect,expression:"isConnect"}],staticClass:"room"},[n("h2",{staticClass:"chattitle",domProps:{innerHTML:e._s(e.msg)}}),e._v(" "),n("div",{staticClass:"chatnotice"},[n("span",{domProps:{innerHTML:e._s(e.userNum)}}),e._v("参与者\n        ")]),e._v(" "),n("div",{ref:"chatArea",staticClass:"chatarea"},[n("div",{staticClass:"chatlist"},e._l(e.chatList,function(t,s){return n("div",{staticClass:"chatitem",class:{me:t.isMe}},[n("div",{staticClass:"userhead"}),e._v(" "),n("span",{staticClass:"username"},[e._v(e._s(t.userName==e.userName?"我":t.userName))]),e._v(" "),n("span",{staticClass:"usermsg"},[e._v(e._s(t.message))])])}))]),e._v(" "),n("div",{staticClass:"room-foot"},[n("div",{staticClass:"chathelp"},[n("div",{staticClass:"nickname-area"},[n("span",{staticClass:"nickname-label"},[e._v("昵称:")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.isUserNameEditing,expression:"!isUserNameEditing"}],staticClass:"nickname-show"},[n("span",{domProps:{innerHTML:e._s(e.userName)},on:{dblclick:function(t){e.isUserNameEditing=!0}}})]),e._v(" "),n("input",{directives:[{name:"show",rawName:"v-show",value:e.isUserNameEditing,expression:"isUserNameEditing"}],staticClass:"nickname-input",attrs:{name:"",type:"text",value:""},domProps:{value:e.userName},on:{keyup:[function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleUserNameEnter(t)},function(t){if(!("button"in t)&&e._k(t.keyCode,"esc",27))return null;e.handleUserNameEsc(t)}],blur:e.handleUserNameEnter}})])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isConnect,expression:"isConnect"}],staticClass:"m-inputmsg"},[n("input",{staticClass:"inputmsg",attrs:{name:"",type:"text"},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13))return null;e.handleMessageInputEnter(t)}}}),e._v(" "),n("span",{staticClass:"sendbtn"},[e._v("send")])])])])])},staticRenderFns:[]}},106:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]}},111:function(e,t){},36:function(e,t,n){"use strict";var s=n(14),i=n(107),o=n(104),a=n.n(o);s.a.use(i.a),t.a=new i.a({routes:[{path:"/",name:"Chat",component:a.a}]})},37:function(e,t,n){n(89);var s=n(33)(n(40),n(106),null,null);e.exports=s.exports},40:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(103),i=(n.n(s),n(43));t.default={name:"app",mounted:function(){var e=document.getElementsByTagName("html")[0];console.log("tools",i);var t=function(){var t=i.getWindowSize().w;e.style.fontSize=100*t/750+"px"};t(),window.addEventListener("resize",t,!1)}}},41:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(44),i=n.n(s),o=n(94),a=n.n(o);t.default={name:"chat",data:function(){return{msg:"欢迎进入聊天室",isConnect:!1,isUserNameEditing:!1,userNum:0,userId:"",userName:"",chatList:[]}},methods:{getUserName:function(e){var t="";if(document.cookie){document.cookie.split(/;\s*/).forEach(function(n,s){if(n){var i=n.split("=");if(i[0]==e)try{t=decodeURIComponent(i[1])}catch(e){}}})}return t},setUserName:function(e,t,n,s,i,o){var a=encodeURIComponent(e)+"="+encodeURIComponent(t);n&&(a+=";expires="+new Date(+new Date+24*n*60*60*1e3).toGMTString()),s&&(a+=";path="+s),i&&(a+=";domain"+i),o&&(a+=";secure"),document.cookie=a},connectSocket:function(){var e=this,t="http://192.168.0.103:3000";-1==window.location.href.indexOf("localhost")&&(t="http://47.91.156.125:3000"),this.socket=a.a.connect(t),this.socket.on("user joined",function(t){e.userNum=t.userNum}),this.socket.on("user left",function(e){}),this.socket.on("new message",function(t){e.chatList.push(t)}),this.socket.on("login",function(t){e.userNum=t.userNum})},handleJoinBtnClick:function(){var e=this;this.connectSocket(),this.socket.emit("add user",e.userName,function(t){e.userName="用户"+t}),this.isConnect=!0},handleUserNameEnter:function(e){this.userName=e.target.value,this.isUserNameEditing=!1,this.socket.emit("set username",this.userName,function(e){_this.userName="用户"+e,_this.setUserName("chatUserName",_this.userName,365)})},handleUserNameEsc:function(){this.isUserNameEditing=!1},handleMessageInputEnter:function(e){var t=e.target.value,n=this;if(t){var s={userName:n.userName,message:t};this.socket.emit("new message",s),this.chatList.push(i()({},s,{isMe:!0})),e.target.value=""}},scrollChatAreaToBottom:function(){window.ref=this.$refs;var e=this.$refs.chatArea;e.offsetHeight<e.scrollHeight&&(e.scrollTop=e.scrollHeight-e.offsetHeight)}},created:function(){console.log("chat created")},mounted:function(){console.log("chat mounted")},updated:function(){console.log("chat updated"),this.scrollChatAreaToBottom()}}},42:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(14),i=n(37),o=n.n(i),a=n(36);s.a.config.productionTip=!1,new s.a({el:"#app",router:a.a,template:"<App/>",components:{App:o.a}})},43:function(e,t,n){"use strict";function s(){var e=0,t=0;return document.documentElement&&document.documentElement.clientHeight?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):document.body&&document.body.clientHeight?(e=document.body.clientWidth,t=document.body.clientHeight):window.innerHeight&&(e=window.innerWidth,t=window.innerHeight),{w:e,h:t}}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"cookie",function(){return i}),t.getWindowSize=s;var i={set:function(e,t,n,s,i,o){var a=encodeURIComponent(e)+"="+encodeURIComponent(t);n&&(a+=";expires="+new Date(+new Date+24*n*60*60*1e3).toGMTString()),s&&(a+=";path="+s),i&&(a+=";domain"+i),o&&(a+=";secure"),document.cookie=a},get:function(e){var t=document.cookie.split(/;\s*/),n="";return t.forEach(function(t,s){var i=t.split("=");if(i[0]===e)try{n=decodeURIComponent(i[1])}catch(e){}}),n},remove:function(e,t,n,s){this.set(e,"",0,t,n,s)}}},88:function(e,t){},89:function(e,t){}},[42]);
//# sourceMappingURL=app.8ef37c3fb6ff5f45eb17.js.map